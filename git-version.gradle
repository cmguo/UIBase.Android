
ext.getGitVersion = {
    def gitRevision = "git -C ${project.getProjectDir()} log -1 --format=%h"
    println(gitRevision)
    gitRevision = gitRevision.execute().text.trim()
    println(gitRevision)
    return gitRevision
}

ext.getGitBranch = {
    def gitBranch = "git -C ${project.getProjectDir()} branch --show-current"
    println(gitBranch)
    gitBranch = gitBranch.execute().text.trim()
    println(gitBranch)
    return gitBranch
}

ext.build_branch = System.getenv("CI_COMMIT_REF_NAME")

if (ext.build_branch == null) {

    ext.build_branch = ext.getGitBranch()

} else {

    println("CI_COMMIT_REF_NAME: " + ext.build_branch)

}

ext.build_version = ext.getGitVersion()
